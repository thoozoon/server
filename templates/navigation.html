<nav class="border-b border-gray-200 bg-white">
    <div class="max-w-4xl mx-auto px-4">
        <div class="flex justify-between items-center h-16">
            <!-- Logo/Brand -->
            <div>
                <h1 class="text-xl font-semibold text-gray-900">
                    <a href="/" class="hover:text-blue-600 transition-colors">COMP 3007</a>
                </h1>
            </div>

            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center space-x-8">
                {{range .Nav}}
                <a
                    href="{{.URL}}"
                    class="text-gray-600 hover:text-blue-600 transition-colors font-medium"
                    hx-boost="true"
                >
                    {{.Name}}
                </a>
                {{end}}

                <!-- User Menu -->
                {{if .User}}
                <div class="relative" id="user-menu">
                    <button
                        onclick="toggleUserMenu()"
                        class="flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                    >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                            ></path>
                        </svg>
                        <span>{{.User.Email}}</span>
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M19 9l-7 7-7-7"
                            ></path>
                        </svg>
                    </button>

                    <div
                        id="user-dropdown"
                        class="hidden absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10"
                    >
                        <div class="py-1">
                            {{if .User.IsAdmin}}
                            <div
                                class="px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wide border-b border-gray-100"
                            >
                                Administrator
                            </div>
                            <a
                                href="/admin/manage-users"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors"
                            >
                                Manage Users
                            </a>
                            <a
                                href="/admin/add-users"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors"
                            >
                                Add Users
                            </a>
                            <div class="border-t border-gray-100"></div>
                            {{end}}
                            <a
                                href="/change-password"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors"
                            >
                                Change Password
                            </a>
                            <a
                                href="/logout"
                                class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors"
                            >
                                Sign Out
                            </a>
                        </div>
                    </div>
                </div>
                {{end}}
            </div>

            <!-- Mobile menu button -->
            <button
                class="md:hidden p-2 text-gray-600 hover:text-blue-600 transition-colors"
                onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16M4 18h16"
                    ></path>
                </svg>
            </button>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobile-menu" class="hidden md:hidden border-t border-gray-200 py-4">
            {{range .Nav}}
            <a
                href="{{.URL}}"
                class="block py-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                hx-boost="true"
            >
                {{.Name}}
            </a>
            {{end}} {{if .User}}
            <div class="border-t border-gray-200 pt-4 mt-4">
                <div class="px-2 text-xs font-medium text-gray-500 uppercase tracking-wide mb-2">
                    {{.User.Email}}
                </div>
                {{if .User.IsAdmin}}
                <a
                    href="/admin/manage-users"
                    class="block py-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                >
                    Manage Users
                </a>
                <a
                    href="/admin/add-users"
                    class="block py-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                >
                    Add Users
                </a>
                {{end}}
                <a
                    href="/change-password"
                    class="block py-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                >
                    Change Password
                </a>
                <a
                    href="/logout"
                    class="block py-2 text-gray-600 hover:text-blue-600 transition-colors font-medium"
                >
                    Sign Out
                </a>
            </div>
            {{end}}
        </div>
    </div>

    <script>
        function toggleUserMenu() {
            const dropdown = document.getElementById("user-dropdown");
            dropdown.classList.toggle("hidden");
        }

        // Close dropdown when clicking outside
        document.addEventListener("click", function (event) {
            const userMenu = document.getElementById("user-menu");
            const dropdown = document.getElementById("user-dropdown");
            if (userMenu && !userMenu.contains(event.target)) {
                dropdown.classList.add("hidden");
            }
        });
    </script>
</nav>
